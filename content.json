{"meta":{"title":"Forheyin","subtitle":null,"description":null,"author":"Forheyin","url":"http://yoursite.com"},"pages":[{"title":"categories","date":"2017-10-10T04:25:16.000Z","updated":"2017-10-10T04:25:16.797Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"个人简介","date":"2017-10-10T03:54:25.000Z","updated":"2017-10-23T10:46:01.929Z","comments":true,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"徐财志 Web前端开发 现居深圳 Email: forheyin.@163.com"},{"title":"tags","date":"2017-10-10T04:22:56.000Z","updated":"2017-10-10T04:22:56.910Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"","slug":"vue模仿PC网易云音乐(一)","date":"2018-03-20T09:47:55.172Z","updated":"2018-03-20T09:47:55.173Z","comments":true,"path":"2018/03/20/vue模仿PC网易云音乐(一)/","link":"","permalink":"http://yoursite.com/2018/03/20/vue模仿PC网易云音乐(一)/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"vue实现可拖动暂停的audio进度条组件","slug":"audio自定义播放器","date":"2018-03-20T08:56:35.000Z","updated":"2018-03-20T10:29:22.070Z","comments":true,"path":"2018/03/20/audio自定义播放器/","link":"","permalink":"http://yoursite.com/2018/03/20/audio自定义播放器/","excerpt":"audio的timeupdate事件来实时监听audio的时间进度 音乐的src是存在vuex里 bus.js（eventBus）用来处理timeupdate监听父组件的事件5 点击或移动时根据step计算time赋值给playSong.currentTime","text":"audio的timeupdate事件来实时监听audio的时间进度 音乐的src是存在vuex里 bus.js（eventBus）用来处理timeupdate监听父组件的事件5 点击或移动时根据step计算time赋值给playSong.currentTime 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187&lt;template&gt; &lt;div class=\"audio\"&gt; &lt;div class=\"con\"&gt; &lt;span class=\"iconfont icon-last\"&gt;&lt;/span&gt; &lt;span class=\"iconfont icon-zanting\" @click=\"stop\" v-if=\"isPlay\"&gt;&lt;/span&gt; &lt;span class=\"iconfont icon-play\" @click=\"play\" v-else &gt;&lt;/span&gt; &lt;span class=\"iconfont icon-next\"&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class=\"pro\"&gt; &lt;span&gt;&#123;&#123;currentTime | timeFormat&#125;&#125;&lt;/span&gt; &lt;p @mousemove=\"mousemove($event)\" @mouseleave=\"mouseEnd($event)\" id=\"pro\"&gt; &lt;i @click=\"jumpTime($event)\"&gt; &lt;b :style=\"&#123;left: step + '%'&#125;\" id=\"steps\" @mousedown=\"mousedown($event)\" @mouseup=\"mouseEnd($event)\"&gt; &lt;/b&gt; &lt;em :style=\"&#123;width: step + '%'&#125;\"&gt;&lt;/em&gt; &lt;/i&gt; &lt;/p&gt; &lt;span&gt;&#123;&#123;$store.state.duration | timeFormat&#125;&#125;&lt;/span&gt; &lt;/div&gt; &lt;audio class=\"play\" id=\"playSong\" @timeupdate=\"updateLyric\"&gt; &lt;source :src=\"mp3Url\" type=\"audio/ogg\" /&gt; &lt;/audio&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import Bus from './bus.js'export default &#123; data () &#123; return &#123; mp3Url: '', isPlay: false, step: 0, currentTime: 0, locked: false, lastStep: 0, time: 0 &#125; &#125;, computed: &#123; getPlayState () &#123; return this.$store.state.mp3Url &#125; &#125;, watch: &#123; getPlayState (val) &#123; this.step = 0 this.mp3Url = val let playSong = document.getElementById('playSong') playSong.load() this.isPlay = true this.play() &#125; &#125;, components: &#123;&#125;, created () &#123; &#125;, mounted () &#123; &#125;, methods: &#123; updateLyric () &#123; let playSong = document.getElementById('playSong') let t = playSong.currentTime if (this.$route.path === '/musicPlay') &#123; Bus.$emit('getTarget', t) &#125; this.currentTime = playSong.currentTime * 1000 if (this.step &lt;= 100) &#123; this.step = this.currentTime / this.$store.state.duration * 100 &#125; &#125;, play () &#123; let playSong = document.getElementById('playSong') this.isPlay = true playSong.play() &#125;, stop () &#123; let playSong = document.getElementById('playSong') playSong.pause() this.isPlay = false &#125;, mousedown (e) &#123; this.locked = true this.lastStep = this.step &#125;, mouseEnd (e) &#123; this.locked = false &#125;, mousemove (e) &#123; if (this.locked) &#123; this.same(e) &#125; &#125;, jumpTime (e) &#123; this.same(e) &#125;, same (e) &#123; // 点击或移动时根据step计算time赋值给playSong.currentTime this.step = e.offsetX / 445 * 100 this.time = this.step * this.$store.state.duration / 1000 / 100 let playSong = document.getElementById('playSong') playSong.currentTime = this.time &#125; &#125;&#125;&lt;/script&gt;&lt;style scoped lang=\"scss\"&gt; .audio &#123; display: flex; align-items: center; .con &#123; width: 200px; padding: 0 25px; flex-shrink: 0; display: flex; justify-content: center; align-items: center; span &#123; text-align: center; flex: 1; font-size: 30px; color: #c62f2f; cursor: pointer; &#125; span:nth-of-type(2) &#123; font-size: 35px; &#125; &#125; .pro &#123; width: 535px; flex-shrink: 0; display: flex; height: 50px; line-height: 50px; p &#123; flex: 1; width: 100%; display: flex; align-items: center; i &#123; width: 445px; flex-shrink: 0; height: 4px; background: #C2C2C4; border-radius: 5px; position: relative; em &#123; position: absolute; width: 0; height: 4px; background: #c62f2f; z-index: 86; border-radius: 5px; &#125; b &#123; position: absolute; left: 0; top: -5px; width: 14px; height: 14px; background: #fff; border-radius: 50%; border: 0.5px solid #ddd; cursor: pointer; z-index: 88; &amp;:after &#123; position: absolute; content: ''; width: 4px; height: 4px; background: #c62f2f; border-radius: 50%; top: 4.5px; left: 4.5px; &#125; &#125; &#125; &#125; span &#123; flex: 1; font-size: 12px; text-align: center; &#125; &#125; &#125;&lt;/style&gt;","categories":[],"tags":[]}]}